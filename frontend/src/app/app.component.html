<ng-container *ngIf="!(authService.loading$ | async); else loading">
  <div class="d-flex flex-column min-vh-100">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-md navbar-light bg-light px-3">
      <a class="navbar-brand fw-normal" href="#">Artist Search</a>

      <!-- Hamburger button (for small screens) -->
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarNavDropdown"
        aria-controls="navbarNavDropdown"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Collapsible Nav Items -->
      <div
        class="collapse navbar-collapse justify-content-end"
        id="navbarNavDropdown"
      >
        <ul class="navbar-nav" *ngIf="isLoggedIn; else guestTabs">
          <li class="nav-item">
            <a
              class="nav-link ps-2"
              routerLink="/"
              routerLinkActive="active"
              [routerLinkActiveOptions]="{ exact: true }"
              >Search</a
            >
          </li>
          <li class="nav-item">
            <a
              class="nav-link ps-2"
              routerLink="/favorites"
              routerLinkActive="active"
              >Favorites</a
            >
          </li>
          <div class="w-100 d-flex justify-content-center mt-2 mt-lg-0">
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle d-flex align-items-center ps-2"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <img
                  [src]="userAvatarUrl"
                  alt="Profile"
                  class="rounded-circle me-2"
                  style="width: 30px; height: 30px"
                />
                <span>{{ userFullName }}</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end">
                <li>
                  <button
                    class="dropdown-item text-danger"
                    (click)="deleteAccount()"
                  >
                    Delete account
                  </button>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <button class="dropdown-item" (click)="logout()">
                    Log out
                  </button>
                </li>
              </ul>
            </li>
          </div>
        </ul>

        <ng-template #guestTabs>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a
                class="nav-link ps-2"
                routerLink="/"
                routerLinkActive="active"
                [routerLinkActiveOptions]="{ exact: true }"
                >Search</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link ps-2"
                routerLink="/login"
                routerLinkActive="active"
                >Log in</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link ps-2"
                routerLink="/register"
                routerLinkActive="active"
                >Register</a
              >
            </li>
          </ul>
        </ng-template>
      </div>
    </nav>

    <!-- Notifications -->
    <app-notification />

    <!-- Main Content -->
    <main class="container my-4 flex-grow-1">
      <router-outlet></router-outlet>
    </main>

    <!-- Sticky Footer -->
    <footer class="bg-dark text-white text-center py-2">
      <p class="mb-0 d-inline-flex align-items-center justify-content-center">
        <span class="me-1">Powered by</span>
        <a
          href="https://www.artsy.net"
          target="_blank"
          class="text-white text-decoration-none d-inline-flex align-items-baseline"
        >
          <img
            src="images/artsy_logo.svg"
            alt="Footer Logo"
            style="height: 20px; vertical-align: baseline;"
            class="me-1"
          />
          <strong>Artsy</strong>
        </a>
      </p>
    </footer>
  </div>
</ng-container>

<ng-template #loading>
  <!-- Fullscreen Centered Spinner -->
  <div class="d-flex vh-100 justify-content-center align-items-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
</ng-template>
